<!DOCTYPE html>
<html>
	<head>
		<title>lego.wojtka</title>
		<script src="https://ajax.googleapis.com/ajax/libs/jquery/3.1.0/jquery.min.js"></script>
		<link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.6/css/bootstrap.min.css" />
		<script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/js/bootstrap.min.js"></script>
	</head>
	<body>
		<div class="container">
			<h1>Nasze zestawy</h1>
			<div class="row">
				<div id="data"></div>
			</div>
		</div>
	</body>
</html>

<script>
	$(document).ready(function(){
		function toObject(arr) {
			var jsonObj = [];
			var headers = arr[0].split(',');
			for(var i = 1; i < arr.length; i++) {
				var data = arr[i].split(',');
				var obj = {};
				for(var j = 0; j < data.length; j++) {
					obj[headers[j].trim()] = data[j].trim().split('"').join('');
				}
				jsonObj.push(obj);
			}
			return jsonObj
		}
		$.ajax({
			url:"https://mikiwys.github.io/lego.wojtka/ownedby-mikiwys.csv",
			dataType:"text",
			success:function(data) {
				var collection = toObject(data.split(/\r?\n|\r/));
				var table_data = '<table class="table table-bordered table-striped">';
				collection.forEach(function(element) {
					console.log(element);
					table_data += '<tr>';
					table_data += '<td>' + element.Number + '</td>';
					table_data += '<td>' + element.Theme + ' - ' + element.Subtheme + ' - ' + element.Name + '</td>';
					table_data += '<td><img style=\"height: 200px\" src=\"' + element.ImageURL + '\"\></td>';
					table_data += '</tr>';
				});
				table_data += '</table>';
				$('#data').html(table_data);
			}
		});
	});
</script>
